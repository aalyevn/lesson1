name: trello-traceability

on:
  pull_request:
    branches:
      - main
      - master
      - development
      - dev
    types:
      - opened
      - edited
      - reopened
      - synchronize

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
    - name: Set up SSH for GitLab
      run: |
        # Настраиваем SSH
        echo "${{ secrets.GITLAB_SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
        chmod 600 ~/.ssh/id_rsa
        ssh-keyscan -H gitlab.com >> ~/.ssh/known_hosts
    
    - name: Push to GitLab
      run: |
        echo "Starting to push repo to GitLab"
        git clone --bare git@github.com:aalyevn/lesson1.git
        cd lesson1.git
        git push --mirror git@gitlab.com:nusi.aalyev/testing1.git